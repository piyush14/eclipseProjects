package jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class JDBCNew {

	public static void main(String[] args) throws Exception {
		// TODO Auto-generated method stub
		copyTable();
		
		

	}
	
	
	public static void copyTable() throws Exception{
		Class.forName("oracle.jdbc.driver.OracleDriver");
		Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","12345");
		
		  Statement st = con.createStatement();
		  Statement st1 = con.createStatement();
		    ResultSet rs = st.executeQuery("select * from dept");
		   // String sql = "INSERT INTO users("+ "name,"+ "active,"+ "login,"+ "password)"+ "VALUES(?,?,?,?)";
		    
		    int rows = st.executeUpdate("CREATE TABLE dept_copy AS SELECT ID, NAME  FROM DEPT");
		    System.out.println("rows : " + rows );
		    
			while(rs.next()){
				System.out.println(rs.getInt("ID")+rs.getString("NAME"));
			}
			
			if(rows == 0){
				System.out.println("table capy not created");
			}
			else{
				System.out.println("Table copy created");
			}

		    con.close();
		  
	}

}
